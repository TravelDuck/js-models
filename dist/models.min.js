function Amount(value,currency){this.setValue(value),this.setCurrency(currency)}function CalendarDay(calendarMonth,day){this.setCalendarMonth(calendarMonth),this.setDay(day)}function CalendarDayRange(startCalendarDay,endCalendarDay){this.setStartCalendarDay(startCalendarDay),this.setEndCalendarDay(endCalendarDay)}function CalendarMonth(year,month){this.setMonth(month),this.setYear(year)}function CalendarMonthRange(startCalendarMonth,endCalendarMonth){this.setStartCalendarMonth(startCalendarMonth),this.setEndCalendarMonth(endCalendarMonth)}function DayOfWeek(number){this.setNumber(number)}function TravelDuck_AvailabilityCalendar(displayElement,property,customSettings,customFunctions){this.setDisplayElement(displayElement),this.setProperty(property),this.setSettings($.extend({},TravelDuck_AvailabilityCalendar.DefaultSettings(),customSettings)),this.setEventFunctions($.extend({},TravelDuck_AvailabilityCalendar.DefaultFunctions(),customFunctions)),this.resetSelectedCalendarDayRange(),this.resetHighlightedCalendarDayRange(),this.resetAvailabilityAccordingToServer(),this.resetCalendarDayStates(),this.resetCalendarDayColourings(),this.draw(),this.refresh()}function TravelDuck_NewsletterSubscriber(email){this.email=email}function TravelDuck_Photo(id,smallSizeUrl,mediumSizeUrl,largeSizeUrl,originalSizeUrl,title,description){this.id=id,this.title=title,this.description=description,this.smallSizeUrl=smallSizeUrl,this.mediumSizeUrl=mediumSizeUrl,this.largeSizeUrl=largeSizeUrl,this.originalSizeUrl=originalSizeUrl}function TravelDuck_Property(propertyId){this.setAttributes([]),this.setId(propertyId)}function TravelDuck_Property_Booking_Request(property,dateRange){this.property=property,this.dateRange=dateRange}function TravelDuck_Property_Booking_Guest(propertyId){this.setId(propertyId)}Amount.prototype.constructor=Amount,Amount.validateCurrency=function(currency){var allowedCurrencies=["GBP"];if(!allowedCurrencies.contains(currency))throw"Invalid currency '"+currency+"'."},Amount.prototype.getValue=function(){return this.value},Amount.prototype.setValue=function(value){this.value=value},Amount.prototype.getCurrency=function(){return this.currency},Amount.prototype.setCurrency=function(currency){this.currency=currency},Amount.prototype.symbol=function(){return"GBP"==this.getCurrency()?"&pound;":"EUR"==this.getCurrency()?"&euro;":"USD"==this.getCurrency()?"&#36;":null},Array.elementsAreEqual=function(e1,e2){var exact=null==arguments[2]?!1:arguments[2];return exact?e1===e2:typeof e1==typeof e2&&e1.isEqualTo?e1.isEqualTo(e2):e1==e2?!0:+e1==+e2},Array.prototype.contains=function(e){for(var exact=null==arguments[1]?!1:arguments[1],i=this.length;i--;)if(Array.elementsAreEqual(this[i],e,exact))return!0;return!1},Array.prototype.unique=function(){var unique=[];return this.forEach(function(value){unique.contains(value)||unique.push(value)}),unique},Array.prototype.remove=function(e){for(var exact=null==arguments[1]?!1:arguments[1],i=this.length;i--;)if(Array.elementsAreEqual(this[i],e,exact))return this.splice(i,1);return this.splice(i,1)},Array.prototype.removeAll=function(e){do{var lengthBeforeRemoval=this.length;this.remove(e);var lengthAfterRemoval=this.length}while(lengthBeforeRemoval>lengthAfterRemoval)},Array.prototype.subtract=function(a){var b=this;return a.forEach(function(value){b.contains(value)&&b.remove(value)}),b},Array.prototype.clone=function(){return this.slice(0)},CalendarDay.prototype.constructor=CalendarDay,CalendarDay.compare=function(a,b){if(!a)return-1;if(!b)return 1;var aCalendarMonth=a.getCalendarMonth(),bCalendarMonth=b.getCalendarMonth(),calendarMonthComparison=CalendarMonth.compare(aCalendarMonth,bCalendarMonth);return 0==calendarMonthComparison?a.getDay()<b.getDay()?-1:a.getDay()>b.getDay()?1:0:calendarMonthComparison},CalendarDay.prototype.isLessThan=function(testCalendarDay){return-1==CalendarDay.compare(this,testCalendarDay)},CalendarDay.prototype.isGreaterThan=function(testCalendarDay){return 1==CalendarDay.compare(this,testCalendarDay)},CalendarDay.prototype.isEqualTo=function(testCalendarDay){return 0==CalendarDay.compare(this,testCalendarDay)},CalendarDay.prototype.isLessThanOrEqualTo=function(testCalendarDay){return CalendarDay.compare(this,testCalendarDay)<=0},CalendarDay.prototype.isGreaterThanOrEqualTo=function(testCalendarDay){return CalendarDay.compare(this,testCalendarDay)>=0},CalendarDay.prototype.getCalendarMonth=function(){return this.calendarMonth},CalendarDay.prototype.setCalendarMonth=function(calendarMonth){this.calendarMonth=calendarMonth},CalendarDay.prototype.getDay=function(){return parseInt(this.day)},CalendarDay.prototype.setDay=function(day){this.day=day},CalendarDay.prototype.getMonth=function(){return this.getCalendarMonth().getMonth()},CalendarDay.prototype.getYear=function(){return this.getCalendarMonth().getYear()},CalendarDay.prototype.plusDays=function(days){var date=this.toDate();return date=new Date(date.setDate(date.getDate()+parseInt(days))),CalendarDay.fromDate(date)},CalendarDay.prototype.plusWeeks=function(weeks){return this.plusDays(7*weeks)},CalendarDay.prototype.minusDays=function(days){return this.plusDays(-days)},CalendarDay.prototype.minusWeeks=function(weeks){return this.minusDays(7*weeks)},CalendarDay.prototype.toDayMonthCodeYear=function(){var monthCodes=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],year=this.getYear(),month=this.getMonth(),day=this.getDay();return day+" "+monthCodes[month-1]+" "+year},CalendarDay.prototype.toDayMonthYearString=function(divider){divider=null==divider?"/":divider;var year=this.getYear(),month=this.getMonth(),day=this.getDay();return day+divider+month+divider+year},CalendarDay.prototype.toMonthDayYearString=function(){var divider=null==arguments[0]?"/":arguments[0],year=this.getYear(),month=this.getMonth(),day=this.getDay();return month+divider+day+divider+year},CalendarDay.prototype.toYearMonthDayString=function(){var divider=null==arguments[0]?"/":arguments[0];return this.getYear()+divider+this.getMonth()+divider+this.getDay()},CalendarDay.prototype.toDate=function(){return new Date(this.getYear(),this.getMonth()-1,this.getDay())},CalendarDay.fromDate=function(date){return CalendarDay.fromYearMonthDay(date.getFullYear(),date.getMonth()+1,date.getDate())},CalendarDay.fromYearMonthDay=function(year,month,day){return new CalendarDay(new CalendarMonth(year,month),day)},CalendarDay.fromYearMonthDayString=function(string){var divider=null==arguments[1]?"/":arguments[1],parts=string.split(divider);return CalendarDay.fromYearMonthDay(parts[0],parts[1],parts[2])},CalendarDay.fromMonthDayYearString=function(string,divider){divider=null==divider?"/":divider;var parts=string.split(divider);return CalendarDay.fromYearMonthDay(parts[2],parts[0],parts[1])},CalendarDay.fromDayMonthYearString=function(string,divider){divider=null==divider?"/":divider;var parts=string.split(divider);return CalendarDay.fromYearMonthDay(parts[2],parts[1],parts[0])},CalendarDay.today=function(){return CalendarDay.fromDate(new Date)},CalendarDay.prototype.dayOfWeek=function(){return new DayOfWeek(this.toDate().getDay())},CalendarDayRange.prototype.constructor=CalendarDayRange,CalendarDayRange.prototype.getStartCalendarDay=function(){return this.startCalendarDay},CalendarDayRange.prototype.setStartCalendarDay=function(startCalendarDay){this.startCalendarDay=startCalendarDay},CalendarDayRange.prototype.getEndCalendarDay=function(){return this.endCalendarDay},CalendarDayRange.prototype.setEndCalendarDay=function(endCalendarDay){this.endCalendarDay=endCalendarDay},CalendarDayRange.prototype.inRange=function(testCalendarDay){return testCalendarDay.isGreaterThanOrEqualTo(this.getStartCalendarDay())&&testCalendarDay.isLessThanOrEqualTo(this.getEndCalendarDay())},CalendarDayRange.prototype.getArrayOfAllCalendarDays=function(){var calendarDays=[];if(!this.getStartCalendarDay()||!this.getEndCalendarDay())return calendarDays;for(var currentCalendarDay=this.getStartCalendarDay();currentCalendarDay.isLessThanOrEqualTo(this.getEndCalendarDay());)calendarDays.push(currentCalendarDay),currentCalendarDay=currentCalendarDay.plusDays(1);return calendarDays},CalendarDayRange.prototype.getArrayOfAllCalendarDaysExcludingEndCalendarDay=function(){var calendarDays=this.getArrayOfAllCalendarDays();return calendarDays.remove(this.getEndCalendarDay()),calendarDays},CalendarDayRange.prototype.countDays=function(){var start=this.getStartCalendarDay().toDate().getTime(),end=this.getEndCalendarDay().toDate().getTime(),oneDay=864e5,difference=end-start;return Math.round(difference/oneDay)+1},CalendarDayRange.prototype.countNights=function(){return this.countDays()-1},CalendarMonth.prototype.constructor=CalendarMonth,CalendarMonth.monthsInAYear=12,CalendarMonth.min=1,CalendarMonth.max=CalendarMonth.min+CalendarMonth.monthsInAYear-1,CalendarMonth.minYear=2013,CalendarMonth.compare=function(a,b){return a.getYear()<b.getYear()||a.getYear()==b.getYear()&&a.getMonth()<b.getMonth()?-1:a.getYear()>b.getYear()||a.getYear()==b.getYear()&&a.getMonth()>b.getMonth()?1:0},CalendarMonth.prototype.isLessThan=function(testCalendarMonth){return-1==CalendarMonth.compare(this,testCalendarMonth)},CalendarMonth.prototype.isGreaterThan=function(testCalendarMonth){return 1==CalendarMonth.compare(this,testCalendarMonth)},CalendarMonth.prototype.isEqualTo=function(testCalendarMonth){return 0==CalendarMonth.compare(this,testCalendarMonth)},CalendarMonth.prototype.isLessThanOrEqualTo=function(testCalendarMonth){return CalendarMonth.compare(this,testCalendarMonth)<=0},CalendarMonth.prototype.isGreaterThanOrEqualTo=function(testCalendarMonth){return CalendarMonth.compare(this,testCalendarMonth)>=0},CalendarMonth.validateMonth=function(month){var intRegex=/^\d+$/,isInteger=intRegex.test(month),tooSmall=month<CalendarMonth.min,tooBig=month>CalendarMonth.max;if(!isInteger||tooSmall||tooBig)throw"CalendarMonth must be an integer between "+CalendarMonth.min+" and "+CalendarMonth.max+"."},CalendarMonth.validateYear=function(year){var intRegex=/^\d+$/,isInteger=intRegex.test(year),tooSmall=year<CalendarMonth.minYear;if(!isInteger||tooSmall)throw"Year must be an integer greater then "+CalendarMonth.minYear+"."},CalendarMonth.prototype.getMonth=function(){return parseInt(this.month)},CalendarMonth.prototype.setMonth=function(month){CalendarMonth.validateMonth(month),this.month=month},CalendarMonth.prototype.name=function(){var monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];return monthNames[this.getMonth()-1]},CalendarMonth.prototype.getYear=function(){return parseInt(this.year)},CalendarMonth.prototype.setYear=function(year){CalendarMonth.validateYear(year),this.year=year},CalendarMonth.prototype.plusMonths=function(numberOfMonths){for(var yearsToAdd=Math.floor((this.getMonth()-1+numberOfMonths)/CalendarMonth.monthsInAYear),newYear=this.getYear()+yearsToAdd,newMonth=this.getMonth()-1+numberOfMonths;0>newMonth;)newMonth+=CalendarMonth.monthsInAYear;return newMonth%=CalendarMonth.monthsInAYear,newMonth++,new CalendarMonth(newYear,newMonth)},CalendarMonth.prototype.minusMonths=function(numberOfMonths){return this.plusMonths(-numberOfMonths)},CalendarMonth.prototype.next=function(){return this.plusMonths(1)},CalendarMonth.prototype.previous=function(){return this.minusMonths(1)},CalendarMonth.generateArrayOfCalendarMonths=function(startCalendarMonth,numberOfMonths){for(var months=[],i=0;numberOfMonths>i;i++)months[i]=startCalendarMonth.plusMonths(i);return months},CalendarMonth.numberOfMonthsBetween=function(startCalendarMonth,endCalendarMonth){var months=(endCalendarMonth.getYear()-startCalendarMonth.getYear())*CalendarMonth.monthsInAYear;return months+=endCalendarMonth.getMonth()-startCalendarMonth.getMonth(),months+1},CalendarMonth.currentMonth=function(){return CalendarDay.today().getCalendarMonth()},CalendarMonth.prototype.toYearMonthString=function(){var divider=null==arguments[0]?"/":arguments[0];return this.getYear()+divider+this.getMonth()},CalendarMonth.prototype.daysInMonth=function(){return new Date(this.getYear(),this.getMonth(),0).getDate()},CalendarMonth.prototype.firstCalendarDay=function(){return new CalendarDay(this,1)},CalendarMonth.prototype.lastCalendarDay=function(){return new CalendarDay(this,this.daysInMonth())},CalendarMonth.prototype.calendarDayRange=function(){return new CalendarDayRange(this.firstCalendarDay(),this.lastCalendarDay())},CalendarMonth.prototype.days=function(){return this.calendarDayRange().getArrayOfAllCalendarDays()},CalendarMonthRange.prototype.constructor=CalendarMonthRange,CalendarMonthRange.prototype.getStartCalendarMonth=function(){return this.startCalendarMonth},CalendarMonthRange.prototype.setStartCalendarMonth=function(startCalendarMonth){this.startCalendarMonth=startCalendarMonth},CalendarMonthRange.prototype.getEndCalendarMonth=function(){return this.endCalendarMonth},CalendarMonthRange.prototype.setEndCalendarMonth=function(endCalendarMonth){this.endCalendarMonth=endCalendarMonth},CalendarMonthRange.prototype.inRange=function(testCalendarMonth){return testCalendarMonth.isGreaterThanOrEqualTo(this.getStartCalendarMonth())&&testCalendarMonth.isLessThanOrEqualTo(this.getEndCalendarMonth())},CalendarMonthRange.prototype.getArrayOfAllCalendarMonths=function(){for(var calendarMonths=[],currentCalendarMonth=this.getStartCalendarMonth();currentCalendarMonth.isLessThanOrEqualTo(this.getEndCalendarMonth());)calendarMonths.push(currentCalendarMonth),currentCalendarMonth=currentCalendarMonth.next();return calendarMonths},CalendarMonthRange.prototype.toCalendarDayRange=function(){var firstCalendarMonth=this.getStartCalendarMonth(),lastCalendarMonth=this.getEndCalendarMonth(),firstCalendarDay=firstCalendarMonth.firstCalendarDay(),lastCalendarDay=lastCalendarMonth.lastCalendarDay();return new CalendarDayRange(firstCalendarDay,lastCalendarDay)},CalendarMonthRange.prototype.getArrayOfAllCalendarDays=function(){var calendarDayRange=this.toCalendarDayRange();return calendarDayRange.getArrayOfAllCalendarDays()},DayOfWeek.prototype.constructor=DayOfWeek,DayOfWeek.prototype.name=function(){var weekday=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return weekday[this.getNumber()]},DayOfWeek.prototype.twoLetterName=function(){return this.name().substr(0,2)},DayOfWeek.prototype.getNumber=function(){return this.number},DayOfWeek.prototype.setNumber=function(number){this.number=number},DayOfWeek.prototype.next=function(){return new DayOfWeek((this.getNumber()+1)%7)},DayOfWeek.prototype.previous=function(){return new DayOfWeek((this.getNumber()+6)%7)},TravelDuck_AvailabilityCalendar.prototype.constructor=TravelDuck_AvailabilityCalendar,TravelDuck_AvailabilityCalendar.Modes={DISPLAY:0,SELECT_START:1,SELECT_END:2},TravelDuck_AvailabilityCalendar.ChangeOverDays={MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,SUNDAY:7},TravelDuck_AvailabilityCalendar.DefaultSettings=function(){return{centralCalendarMonth:CalendarMonth.currentMonth(),monthsToDisplayToLeft:0,monthsToDisplayToRight:0,monthsToBufferToLeft:2,monthsToBufferToRight:2,changeOverDay:TravelDuck_AvailabilityCalendar.ChangeOverDays.SATURDAY,mode:TravelDuck_AvailabilityCalendar.Modes.DISPLAY,numberOfAdults:1,numberOfChildren:0,numberOfInfants:0,numberOfPets:0}},TravelDuck_AvailabilityCalendar.DefaultFunctions=function(){return{onUpdateAvailabilityStart:function(){},onUpdateAvailabilityComplete:function(){},onUpdateAvailabilityError:function(){},onUpdateCalculatedAmountStart:function(){},onUpdateCalculatedAmountComplete:function(){},onUpdateCalculatedAmountError:function(){},onCalculatedAmountChange:function(){},onCalculatedAmountReset:function(){},onSelectedCalendarDayRangeStartCalendarDayChange:function(){},onSelectedCalendarDayRangeStartCalendarDayReset:function(){},onSelectedCalendarDayRangeEndCalendarDayChange:function(){},onSelectedCalendarDayRangeEndCalendarDayReset:function(){},onSelectedCalendarDayRangeChange:function(){},onSelectedCalendarDayRangeReset:function(){},onHighlightedCalendarDayRangeStartCalendarDayChange:function(){},onHighlightedCalendarDayRangeStartCalendarDayReset:function(){},onHighlightedCalendarDayRangeEndCalendarDayChange:function(){},onHighlightedCalendarDayRangeEndCalendarDayReset:function(){},onHighlightedCalendarDayRangeChange:function(){},onHighlightedCalendarDayRangeReset:function(){}}},TravelDuck_AvailabilityCalendar.prototype.getNumberOfAdults=function(){return this.getSettings().numberOfAdults},TravelDuck_AvailabilityCalendar.prototype.setNumberOfAdults=function(numberOfAdults){this.getSettings().numberOfAdults=numberOfAdults,this.refreshCalculatedAmount()},TravelDuck_AvailabilityCalendar.prototype.getNumberOfChildren=function(){return this.getSettings().numberOfChildren},TravelDuck_AvailabilityCalendar.prototype.setNumberOfChildren=function(numberOfChildren){this.getSettings().numberOfChildren=numberOfChildren,this.refreshCalculatedAmount()},TravelDuck_AvailabilityCalendar.prototype.getNumberOfInfants=function(){return this.getSettings().numberOfInfants},TravelDuck_AvailabilityCalendar.prototype.setNumberOfInfants=function(numberOfInfants){this.getSettings().numberOfInfants=numberOfInfants,this.refreshCalculatedAmount()},TravelDuck_AvailabilityCalendar.prototype.getNumberOfPets=function(){return this.getSettings().numberOfPets},TravelDuck_AvailabilityCalendar.prototype.setNumberOfPets=function(numberOfPets){this.getSettings().numberOfPets=numberOfPets,this.refreshCalculatedAmount()},TravelDuck_AvailabilityCalendar.prototype.getDisplayElement=function(){return this.displayElement},TravelDuck_AvailabilityCalendar.prototype.setDisplayElement=function(displayElement){this.displayElement=displayElement},TravelDuck_AvailabilityCalendar.prototype.getProperty=function(){return this.property},TravelDuck_AvailabilityCalendar.prototype.setProperty=function(property){this.property=property},TravelDuck_AvailabilityCalendar.prototype.getSettings=function(){return this.settings},TravelDuck_AvailabilityCalendar.prototype.setSettings=function(settings){this.settings=settings},TravelDuck_AvailabilityCalendar.prototype.getEventFunctions=function(){return this.functions},TravelDuck_AvailabilityCalendar.prototype.setEventFunctions=function(functions){this.functions=functions},TravelDuck_AvailabilityCalendar.prototype.getSelectedCalendarDayRangeStartCalendarDay=function(){return this.selectedCalendarDayRangeStartCalendarDay},TravelDuck_AvailabilityCalendar.prototype.setSelectedCalendarDayRangeStartCalendarDay=function(startCalendarDay){this.selectedCalendarDayRangeStartCalendarDay=startCalendarDay,this.getEventFunctions().onSelectedCalendarDayRangeStartCalendarDayChange(),this.getSelectedCalendarDayRangeEndCalendarDay()&&this.selectedCalendarDayRangeChanged()},TravelDuck_AvailabilityCalendar.prototype.resetSelectedCalendarDayRangeStartCalendarDay=function(){this.selectedCalendarDayRangeStartCalendarDay=null;var suppressEventTrigger=arguments[0];suppressEventTrigger||this.getEventFunctions().onSelectedCalendarDayRangeStartCalendarDayReset(),this.getSelectedCalendarDayRangeEndCalendarDay()&&this.selectedCalendarDayRangeChanged()},TravelDuck_AvailabilityCalendar.prototype.getSelectedCalendarDayRangeEndCalendarDay=function(){return this.selectedCalendarDayRangeEndCalendarDay},TravelDuck_AvailabilityCalendar.prototype.setSelectedCalendarDayRangeEndCalendarDay=function(endCalendarDay){this.selectedCalendarDayRangeEndCalendarDay=endCalendarDay,this.getEventFunctions().onSelectedCalendarDayRangeEndCalendarDayChange(),this.getSelectedCalendarDayRangeStartCalendarDay()&&this.selectedCalendarDayRangeChanged()},TravelDuck_AvailabilityCalendar.prototype.resetSelectedCalendarDayRangeEndCalendarDay=function(){this.selectedCalendarDayRangeEndCalendarDay=null;var suppressEventTrigger=arguments[0];suppressEventTrigger||this.getEventFunctions().onSelectedCalendarDayRangeEndCalendarDayReset(),this.getSelectedCalendarDayRangeStartCalendarDay()&&this.selectedCalendarDayRangeChanged()},TravelDuck_AvailabilityCalendar.prototype.getSelectedCalendarDayRange=function(){return this.getSelectedCalendarDayRangeStartCalendarDay()&&this.getSelectedCalendarDayRangeEndCalendarDay()?new CalendarDayRange(this.getSelectedCalendarDayRangeStartCalendarDay(),this.getSelectedCalendarDayRangeEndCalendarDay()):null},TravelDuck_AvailabilityCalendar.prototype.setSelectedCalendarDayRange=function(calendarDayRange){var suppressResetEventTriggers=!0;this.resetSelectedCalendarDayRangeStartCalendarDay(suppressResetEventTriggers),this.resetSelectedCalendarDayRangeEndCalendarDay(suppressResetEventTriggers),this.setSelectedCalendarDayRangeStartCalendarDay(calendarDayRange.getStartCalendarDay()),this.setSelectedCalendarDayRangeEndCalendarDay(calendarDayRange.getEndCalendarDay())},TravelDuck_AvailabilityCalendar.prototype.resetSelectedCalendarDayRange=function(){this.resetSelectedCalendarDayRangeStartCalendarDay(),this.resetSelectedCalendarDayRangeEndCalendarDay();var suppressEventTrigger=arguments[0];suppressEventTrigger||this.getEventFunctions().onSelectedCalendarDayRangeReset()},TravelDuck_AvailabilityCalendar.prototype.selectedCalendarDayRangeChanged=function(){this.getEventFunctions().onSelectedCalendarDayRangeChange(),this.refreshCalculatedAmount()},TravelDuck_AvailabilityCalendar.prototype.getHighlightedCalendarDayRangeStartCalendarDay=function(){return this.highlightedCalendarDayRangeStartCalendarDay},TravelDuck_AvailabilityCalendar.prototype.setHighlightedCalendarDayRangeStartCalendarDay=function(startCalendarDay){this.highlightedCalendarDayRangeStartCalendarDay=startCalendarDay,this.getEventFunctions().onHighlightedCalendarDayRangeStartCalendarDayChange(),this.getHighlightedCalendarDayRangeEndCalendarDay()&&this.highlightedCalendarDayRangeChanged()},TravelDuck_AvailabilityCalendar.prototype.resetHighlightedCalendarDayRangeStartCalendarDay=function(){this.highlightedCalendarDayRangeStartCalendarDay=null;var suppressEventTrigger=arguments[0];suppressEventTrigger||this.getEventFunctions().onHighlightedCalendarDayRangeStartCalendarDayReset(),this.getHighlightedCalendarDayRangeEndCalendarDay()&&this.highlightedCalendarDayRangeChanged()},TravelDuck_AvailabilityCalendar.prototype.getHighlightedCalendarDayRangeEndCalendarDay=function(){return this.highlightedCalendarDayRangeEndCalendarDay},TravelDuck_AvailabilityCalendar.prototype.setHighlightedCalendarDayRangeEndCalendarDay=function(endCalendarDay){this.highlightedCalendarDayRangeEndCalendarDay=endCalendarDay,this.getEventFunctions().onHighlightedCalendarDayRangeEndCalendarDayChange(),this.getHighlightedCalendarDayRangeStartCalendarDay()&&this.highlightedCalendarDayRangeChanged()},TravelDuck_AvailabilityCalendar.prototype.resetHighlightedCalendarDayRangeEndCalendarDay=function(){this.highlightedCalendarDayRangeEndCalendarDay=null;var suppressEventTrigger=arguments[0];suppressEventTrigger||this.getEventFunctions().onHighlightedCalendarDayRangeEndCalendarDayReset(),this.getHighlightedCalendarDayRangeStartCalendarDay()&&this.highlightedCalendarDayRangeChanged()},TravelDuck_AvailabilityCalendar.prototype.getHighlightedCalendarDayRange=function(){return this.getHighlightedCalendarDayRangeStartCalendarDay()&&this.getHighlightedCalendarDayRangeEndCalendarDay()?new CalendarDayRange(this.getHighlightedCalendarDayRangeStartCalendarDay(),this.getHighlightedCalendarDayRangeEndCalendarDay()):null},TravelDuck_AvailabilityCalendar.prototype.setHighlightedCalendarDayRange=function(calendarDayRange){var suppressResetEventTriggers=!0;this.resetHighlightedCalendarDayRangeStartCalendarDay(suppressResetEventTriggers),this.resetHighlightedCalendarDayRangeEndCalendarDay(suppressResetEventTriggers),this.setHighlightedCalendarDayRangeStartCalendarDay(calendarDayRange.getStartCalendarDay()),this.setHighlightedCalendarDayRangeEndCalendarDay(calendarDayRange.getEndCalendarDay())},TravelDuck_AvailabilityCalendar.prototype.resetHighlightedCalendarDayRange=function(){this.resetHighlightedCalendarDayRangeStartCalendarDay(),this.resetHighlightedCalendarDayRangeEndCalendarDay();var suppressEventTrigger=arguments[0];suppressEventTrigger||this.getEventFunctions().onHighlightedCalendarDayRangeReset()},TravelDuck_AvailabilityCalendar.prototype.highlightedCalendarDayRangeChanged=function(){this.getEventFunctions().onHighlightedCalendarDayRangeChange()},TravelDuck_AvailabilityCalendar.prototype.getCalculatedAmountAccordingToServer=function(){return this.calculatedAmount},TravelDuck_AvailabilityCalendar.prototype.refreshCalculatedAmount=function(){this.getSelectedCalendarDayRange()&&this.loadCalculatedAmountAccordingToServer(function(){},function(){})},TravelDuck_AvailabilityCalendar.prototype.setCalculatedAmountAccordingToServer=function(calculatedAmount){this.calculatedAmount=calculatedAmount,this.getEventFunctions().onCalculatedAmountChange(calculatedAmount)},TravelDuck_AvailabilityCalendar.prototype.resetCalculatedAmountAccordingToServer=function(){this.calculatedAmount=null,this.getEventFunctions().onCalculatedAmountReset()},TravelDuck_AvailabilityCalendar.prototype.calculateNumberOfMonthsToDisplay=function(){var monthsToDisplayToLeft=parseInt(this.getSettings().monthsToDisplayToLeft),monthsToDisplayToRight=parseInt(this.getSettings().monthsToDisplayToRight);return monthsToDisplayToLeft+monthsToDisplayToRight+1},TravelDuck_AvailabilityCalendar.prototype.getNumberOfMonthsToLoad=function(){var monthsToLeft=parseInt(this.getSettings().monthsToDisplayToLeft),monthsToRight=parseInt(this.getSettings().monthsToDisplayToRight);return monthsToLeft+monthsToRight+5},TravelDuck_AvailabilityCalendar.prototype.firstCalendarMonthToDisplay=function(){var mainCalendarMonth=this.getSettings().centralCalendarMonth,monthsToDisplayToLeft=this.getSettings().monthsToDisplayToLeft;return mainCalendarMonth.minusMonths(monthsToDisplayToLeft)},TravelDuck_AvailabilityCalendar.prototype.lastCalendarMonthToDisplay=function(){var mainCalendarMonth=this.getSettings().centralCalendarMonth,monthsToRight=this.getSettings().monthsToDisplayToRight;return mainCalendarMonth.plusMonths(monthsToRight)},TravelDuck_AvailabilityCalendar.prototype.calendarMonthRangeToLoad=function(){return new CalendarMonthRange(this.firstCalendarMonthToDisplay(),this.lastCalendarMonthToDisplay())},TravelDuck_AvailabilityCalendar.prototype.firstCalendarMonthToLoad=function(){var mainCalendarMonth=this.getSettings().centralCalendarMonth,monthsToLeft=this.getSettings().monthsToDisplayToLeft;return mainCalendarMonth.minusMonths(monthsToLeft+2)},TravelDuck_AvailabilityCalendar.prototype.lastCalendarMonthToLoad=function(){var mainCalendarMonth=this.getSettings().centralCalendarMonth,monthsToRight=this.getSettings().monthsToDisplayToRight;return mainCalendarMonth.plusMonths(monthsToRight+2)},TravelDuck_AvailabilityCalendar.prototype.calendarMonthRangeToLoad=function(){return new CalendarMonthRange(this.firstCalendarMonthToLoad(),this.lastCalendarMonthToLoad())},TravelDuck_AvailabilityCalendar.prototype.greatestSelectableCalendarDay=function(){var $this=this;if(!$this.getSelectedCalendarDayRangeStartCalendarDay())return null;var greatestSelectableDay=null;return this.unavailableAccordingToServerCalendarDays.forEach(function(calendarDay){calendarDay.isGreaterThan($this.getSelectedCalendarDayRangeStartCalendarDay())&&(greatestSelectableDay||(greatestSelectableDay=calendarDay),calendarDay.isLessThan(greatestSelectableDay)&&(greatestSelectableDay=calendarDay))}),greatestSelectableDay||(greatestSelectableDay=$this.getSelectedCalendarDayRangeStartCalendarDay(),this.availableAccordingToServerCalendarDays.forEach(function(calendarDay){calendarDay.isGreaterThan(greatestSelectableDay)&&(greatestSelectableDay=calendarDay)}),greatestSelectableDay=greatestSelectableDay.plusDays(1)),greatestSelectableDay},TravelDuck_AvailabilityCalendar.prototype.resetAvailabilityAccordingToServer=function(){this.availableAccordingToServerCalendarDays=[],this.unavailableAccordingToServerCalendarDays=[]},TravelDuck_AvailabilityCalendar.prototype.loadAvailabilityAccordingToServer=function(successCallback,failureCallback){successCallback=successCallback?successCallback:function(){},failureCallback=failureCallback?failureCallback:function(){};var $this=this,property=this.getProperty();property.availability(this.calendarMonthRangeToLoad(),function(availability){$this.resetAvailabilityAccordingToServer(),$this.availableAccordingToServerCalendarDays=availability.available,$this.unavailableAccordingToServerCalendarDays=availability.unavailable,successCallback()},failureCallback)},TravelDuck_AvailabilityCalendar.prototype.resetCalendarDayStates=function(){this.allAvailableCalendarDays=[],this.availableCalendarDays=[],this.unavailableCalendarDays=[],this.selectedCalendarDays=[],this.highlightedCalendarDays=[]},TravelDuck_AvailabilityCalendar.prototype.generateCalendarDayStates=function(){this.resetCalendarDayStates(),this.getHighlightedCalendarDayRange()&&(this.highlightedCalendarDays=this.getHighlightedCalendarDayRange().getArrayOfAllCalendarDaysExcludingEndCalendarDay()),this.getSelectedCalendarDayRange()&&(this.selectedCalendarDays=this.getSelectedCalendarDayRange().getArrayOfAllCalendarDaysExcludingEndCalendarDay()),this.unavailableCalendarDays=this.unavailableAccordingToServerCalendarDays.clone().unique(),this.availableCalendarDays=this.availableAccordingToServerCalendarDays.clone().unique(),this.allAvailableCalendarDays=this.availableCalendarDays.clone(),this.selectedCalendarDays.subtract(this.highlightedCalendarDays),this.unavailableCalendarDays.subtract(this.highlightedCalendarDays),this.unavailableCalendarDays.subtract(this.selectedCalendarDays),this.availableCalendarDays.subtract(this.highlightedCalendarDays),this.availableCalendarDays.subtract(this.selectedCalendarDays),this.availableCalendarDays.subtract(this.unavailableCalendarDays)},TravelDuck_AvailabilityCalendar.prototype.resetCalendarDayColourings=function(){this.availableToAvailableColouredCalendarDays=[],this.availableToUnavailableColouredCalendarDays=[],this.availableToHighlightedColouredCalendarDays=[],this.availableToSelectedColouredCalendarDays=[],this.availableToUnknownColouredCalendarDays=[],this.unavailableToAvailableColouredCalendarDays=[],this.unavailableToUnavailableColouredCalendarDays=[],this.unavailableToHighlightedColouredCalendarDays=[],this.unavailableToSelectedColouredCalendarDays=[],this.unavailableToUnknownColouredCalendarDays=[],this.highlightedToAvailableColouredCalendarDays=[],this.highlightedToUnavailableColouredCalendarDays=[],this.highlightedToHighlightedColouredCalendarDays=[],this.highlightedToSelectedColouredCalendarDays=[],this.highlightedToUnknownColouredCalendarDays=[],this.selectedToAvailableColouredCalendarDays=[],this.selectedToUnavailableColouredCalendarDays=[],this.selectedToHighlightedColouredCalendarDays=[],this.selectedToSelectedColouredCalendarDays=[],this.selectedToUnknownColouredCalendarDays=[],this.unknownToAvailableColouredCalendarDays=[],this.unknownToUnavailableColouredCalendarDays=[],this.unknownToHighlightedColouredCalendarDays=[],this.unknownToSelectedColouredCalendarDays=[],this.unknownToUnknownColouredCalendarDays=[]},TravelDuck_AvailabilityCalendar.prototype.generateCalendarDayColourings=function(){var $this=this;this.resetCalendarDayColourings();var months=this.calendarMonthRangeToLoad().getArrayOfAllCalendarMonths();months.forEach(function(calendarMonth){for(var daysInMonth=calendarMonth.daysInMonth(),day=1;daysInMonth>=day;day++){var currentDay=new CalendarDay(calendarMonth,day),previousDay=currentDay.minusDays(1),currentDayIsAvailable=$this.availableCalendarDays.contains(currentDay),previousDayIsAvailable=$this.availableCalendarDays.contains(previousDay),currentDayIsUnavailable=$this.unavailableCalendarDays.contains(currentDay),previousDayIsUnavailable=$this.unavailableCalendarDays.contains(previousDay),currentDayIsSelected=$this.selectedCalendarDays.contains(currentDay),previousDayIsSelected=$this.selectedCalendarDays.contains(previousDay),currentDayIsHighlighted=$this.highlightedCalendarDays.contains(currentDay),previousDayIsHighlighted=$this.highlightedCalendarDays.contains(previousDay),currentDayIsUnknown=!(currentDayIsAvailable||currentDayIsUnavailable||currentDayIsSelected||currentDayIsHighlighted),previousDayIsUnknown=!(previousDayIsAvailable||previousDayIsUnavailable||previousDayIsSelected||previousDayIsHighlighted);
previousDayIsAvailable?currentDayIsAvailable?$this.availableToAvailableColouredCalendarDays.push(currentDay):currentDayIsUnavailable?$this.availableToUnavailableColouredCalendarDays.push(currentDay):currentDayIsHighlighted?$this.availableToHighlightedColouredCalendarDays.push(currentDay):currentDayIsSelected?$this.availableToSelectedColouredCalendarDays.push(currentDay):currentDayIsUnknown&&$this.availableToUnknownColouredCalendarDays.push(currentDay):previousDayIsUnavailable?currentDayIsAvailable?$this.unavailableToAvailableColouredCalendarDays.push(currentDay):currentDayIsUnavailable?$this.unavailableToUnavailableColouredCalendarDays.push(currentDay):currentDayIsHighlighted?$this.unavailableToHighlightedColouredCalendarDays.push(currentDay):currentDayIsSelected?$this.unavailableToSelectedColouredCalendarDays.push(currentDay):currentDayIsUnknown&&$this.unavailableToUnknownColouredCalendarDays.push(currentDay):previousDayIsHighlighted?$this.availableCalendarDays.contains(currentDay)?$this.highlightedToAvailableColouredCalendarDays.push(currentDay):currentDayIsUnavailable?$this.highlightedToUnavailableColouredCalendarDays.push(currentDay):currentDayIsHighlighted?$this.highlightedToHighlightedColouredCalendarDays.push(currentDay):currentDayIsSelected?$this.highlightedToSelectedColouredCalendarDays.push(currentDay):currentDayIsUnknown&&$this.highlightedToUnknownColouredCalendarDays.push(currentDay):previousDayIsSelected?$this.availableCalendarDays.contains(currentDay)?$this.selectedToAvailableColouredCalendarDays.push(currentDay):currentDayIsUnavailable?$this.selectedToUnavailableColouredCalendarDays.push(currentDay):currentDayIsHighlighted?$this.selectedToHighlightedColouredCalendarDays.push(currentDay):currentDayIsSelected?$this.selectedToSelectedColouredCalendarDays.push(currentDay):currentDayIsUnknown&&$this.selectedToUnknownColouredCalendarDays.push(currentDay):previousDayIsUnknown&&($this.availableCalendarDays.contains(currentDay)?$this.unknownToAvailableColouredCalendarDays.push(currentDay):currentDayIsUnavailable?$this.unknownToUnavailableColouredCalendarDays.push(currentDay):currentDayIsHighlighted?$this.unknownToHighlightedColouredCalendarDays.push(currentDay):currentDayIsSelected?$this.unknownToSelectedColouredCalendarDays.push(currentDay):currentDayIsUnknown&&$this.unknownToUnknownColouredCalendarDays.push(currentDay))}})},TravelDuck_AvailabilityCalendar.prototype.resetCalendarDaySelectability=function(){this.selectableCalendarDays=[]},TravelDuck_AvailabilityCalendar.prototype.generateCalendarDaySelectability=function(){var $this=this;this.resetCalendarDaySelectability();var months=this.calendarMonthRangeToLoad().getArrayOfAllCalendarMonths(),greatestSelectableCalendarDay=this.greatestSelectableCalendarDay();months.forEach(function(calendarMonth){for(var daysInMonth=calendarMonth.daysInMonth(),day=1;daysInMonth>=day;day++){var currentDay=new CalendarDay(calendarMonth,day),previous=currentDay.minusDays(1),currentDayIsAvailable=$this.allAvailableCalendarDays.contains(currentDay),previousDayIsAvailable=$this.allAvailableCalendarDays.contains(previous),selectableAccordingToModeAndAvailability=!1;$this.getSettings().mode==TravelDuck_AvailabilityCalendar.Modes.SELECT_START?selectableAccordingToModeAndAvailability=currentDayIsAvailable:$this.getSettings().mode==TravelDuck_AvailabilityCalendar.Modes.SELECT_END&&(selectableAccordingToModeAndAvailability=previousDayIsAvailable&&currentDay.isGreaterThan($this.getSelectedCalendarDayRangeStartCalendarDay())&&currentDay.isLessThanOrEqualTo(greatestSelectableCalendarDay)),selectableAccordingToModeAndAvailability&&$this.selectableCalendarDays.push(currentDay)}})},TravelDuck_AvailabilityCalendar.prototype.updateAvailability=function(successCallback,failureCallback){successCallback=successCallback?successCallback:function(){},failureCallback=failureCallback?failureCallback:function(){};var $this=this;this.getEventFunctions().onUpdateAvailabilityStart(),this.loadAvailabilityAccordingToServer(function(){$this.getEventFunctions().onUpdateAvailabilityComplete(),successCallback()},function(){$this.getEventFunctions().onUpdateAvailabilityError(),failureCallback()})},TravelDuck_AvailabilityCalendar.prototype.loadCalculatedAmountAccordingToServer=function(successCallback,failureCallback){successCallback=successCallback?successCallback:function(){},failureCallback=failureCallback?failureCallback:function(){};var $this=this,selectedCalendarDayRange=this.getSelectedCalendarDayRange();selectedCalendarDayRange?(this.getEventFunctions().onUpdateCalculatedAmountStart(),this.getProperty().calculatedPrice(selectedCalendarDayRange,this.getNumberOfAdults(),this.getNumberOfChildren(),this.getNumberOfInfants(),this.getNumberOfPets(),function(response){$this.setCalculatedAmountAccordingToServer(response),$this.getEventFunctions().onUpdateCalculatedAmountComplete(),successCallback()},function(){$this.getEventFunctions().onUpdateCalculatedAmountError(),failureCallback()})):(this.setCalculatedAmountAccordingToServer(null),failureCallback())},TravelDuck_AvailabilityCalendar.prototype.changeModeToDisplay=function(){this.getSettings().mode=TravelDuck_AvailabilityCalendar.Modes.DISPLAY,this.resetHighlightedCalendarDayRange(),this.draw()},TravelDuck_AvailabilityCalendar.prototype.changeModeToSelectStart=function(){this.getSettings().mode=TravelDuck_AvailabilityCalendar.Modes.SELECT_START,this.resetSelectedCalendarDayRange(),this.draw()},TravelDuck_AvailabilityCalendar.prototype.changeModeToSelectEnd=function(){if(this.getSettings().mode=TravelDuck_AvailabilityCalendar.Modes.SELECT_END,!this.getSelectedCalendarDayRangeStartCalendarDay())throw"Cannot enter SELECT_END mode without a selected start CalendarDay.";this.draw()},TravelDuck_AvailabilityCalendar.prototype.refresh=function(){var successCallback=arguments[0]?arguments[0]:function(){},failureCallback=arguments[1]?arguments[1]:function(){},$this=this;this.updateAvailability(function(){$this.draw(),successCallback()},failureCallback())},TravelDuck_AvailabilityCalendar.prototype.draw=function(){var $this=this,beforeShowDay=function(date){var calendarDay=CalendarDay.fromDate(date),selectable=$this.selectableCalendarDays.contains(calendarDay),classes="ui-datepicker-day";return $this.availableToAvailableColouredCalendarDays.contains(calendarDay)?[selectable,classes+" available-to-available"]:$this.availableToUnavailableColouredCalendarDays.contains(calendarDay)?[selectable,classes+" available-to-unavailable"]:$this.availableToHighlightedColouredCalendarDays.contains(calendarDay)?[selectable,classes+" available-to-highlighted"]:$this.availableToSelectedColouredCalendarDays.contains(calendarDay)?[selectable,classes+" available-to-selected"]:$this.availableToUnknownColouredCalendarDays.contains(calendarDay)?[selectable,classes+" availableToUnknown"]:$this.unavailableToAvailableColouredCalendarDays.contains(calendarDay)?[selectable,classes+" unavailable-to-available"]:$this.unavailableToUnavailableColouredCalendarDays.contains(calendarDay)?[selectable,classes+" unavailable-to-unavailable"]:$this.unavailableToHighlightedColouredCalendarDays.contains(calendarDay)?[selectable,classes+" unavailable-to-highlighted"]:$this.unavailableToSelectedColouredCalendarDays.contains(calendarDay)?[selectable,classes+" unavailable-to-selected"]:$this.unavailableToUnknownColouredCalendarDays.contains(calendarDay)?[selectable,classes+" unavailable-to-unknown"]:$this.highlightedToAvailableColouredCalendarDays.contains(calendarDay)?[selectable,classes+" highlighted-to-available"]:$this.highlightedToUnavailableColouredCalendarDays.contains(calendarDay)?[selectable,classes+" highlighted-to-unavailable"]:$this.highlightedToHighlightedColouredCalendarDays.contains(calendarDay)?[selectable,classes+" highlighted-to-highlighted"]:$this.highlightedToSelectedColouredCalendarDays.contains(calendarDay)?[selectable,classes+" highlighted-to-selected"]:$this.highlightedToUnknownColouredCalendarDays.contains(calendarDay)?[selectable,classes+" highlighted-to-unknown"]:$this.selectedToAvailableColouredCalendarDays.contains(calendarDay)?[selectable,classes+" selected-to-available"]:$this.selectedToUnavailableColouredCalendarDays.contains(calendarDay)?[selectable,classes+" selected-to-unavailable"]:$this.selectedToHighlightedColouredCalendarDays.contains(calendarDay)?[selectable,classes+" selected-to-highlighted"]:$this.selectedToSelectedColouredCalendarDays.contains(calendarDay)?[selectable,classes+" selected-to-selected"]:$this.selectedToUnknownColouredCalendarDays.contains(calendarDay)?[selectable,classes+" selected-to-unknown"]:$this.unknownToAvailableColouredCalendarDays.contains(calendarDay)?[selectable,classes+" unknown-to-available"]:$this.unknownToUnavailableColouredCalendarDays.contains(calendarDay)?[selectable,classes+" unknown-to-unavailable"]:$this.unknownToHighlightedColouredCalendarDays.contains(calendarDay)?[selectable,classes+" unknown-to-highlighted"]:$this.unknownToSelectedColouredCalendarDays.contains(calendarDay)?[selectable,classes+" unknown-to-selected"]:$this.unknownToUnknownColouredCalendarDays.contains(calendarDay)?[selectable,classes+" unknown-to-unknown"]:[!1]};this.generateCalendarDayStates(),this.generateCalendarDayColourings(),this.generateCalendarDaySelectability();var displayElement=$(this.getDisplayElement());this.datePickerHasBeenInitialized?displayElement.datepicker("refresh"):(displayElement.datepicker({dateFormat:"yy/mm/dd",numberOfMonths:this.calculateNumberOfMonthsToDisplay(),firstDay:this.getSettings().changeOverDay,defaultDate:new CalendarDay(this.firstCalendarMonthToDisplay(),1).toDate(),minDate:0,beforeShowDay:beforeShowDay,onChangeMonthYear:function(year,month){$this.getSettings().centralCalendarMonth=new CalendarMonth(year,month),$this.draw(),$this.refresh()},onSelect:function(dateString){var calendarDay=CalendarDay.fromYearMonthDayString(dateString);switch($this.getSettings().mode){case TravelDuck_AvailabilityCalendar.Modes.SELECT_START:$this.setSelectedCalendarDayRangeStartCalendarDay(calendarDay),$this.changeModeToSelectEnd();break;case TravelDuck_AvailabilityCalendar.Modes.SELECT_END:$this.setSelectedCalendarDayRangeEndCalendarDay(calendarDay),$this.changeModeToDisplay()}}}),this.datePickerHasBeenInitialized=!0),$this.attachMouseEventsToDatepicker(),$(displayElement).find(".ui-state-highlight").removeClass("ui-state-highlight"),$(displayElement).find(".ui-state-active").removeClass("ui-state-active").removeClass("ui-state-hover")},TravelDuck_AvailabilityCalendar.prototype.attachMouseEventsToDatepicker=function(){var $this=this;$this.getSettings().mode==TravelDuck_AvailabilityCalendar.Modes.SELECT_END&&setTimeout(function(){$(".ui-state-default").on("mouseover",function(){var day=$(this).text(),monthString=$(".ui-datepicker-month",$(this).parent().parent().parent().parent().parent()).text(),year=$(".ui-datepicker-year",$(this).parent().parent().parent().parent().parent()).text(),date=new Date(Date.parse(day+" "+monthString+" "+year)),calendarDay=CalendarDay.fromDate(date);if(!calendarDay.isEqualTo($this.getHighlightedCalendarDayRangeEndCalendarDay())){var greatestSelectableCalendarDay=$this.greatestSelectableCalendarDay();calendarDay.isGreaterThan(greatestSelectableCalendarDay)&&greatestSelectableCalendarDay&&(calendarDay=greatestSelectableCalendarDay),$this.setHighlightedCalendarDayRange(new CalendarDayRange($this.getSelectedCalendarDayRangeStartCalendarDay(),calendarDay)),$this.draw()}})},0)},TravelDuck_NewsletterSubscriber.prototype.constructor=TravelDuck_NewsletterSubscriber,TravelDuck_NewsletterSubscriber.subscribeEmailAddress=function(emailAddress,successCallback,failureCallback){$.ajax({url:"https://travelduck.co/api/rest/v1/newsletter/subscribe",type:"POST",dataType:"json",crossDomain:!0,cache:!1,timeout:1e4,data:{email:emailAddress},success:successCallback,error:function(jqXHR,textStatus){var errors=[],message="An error occurred";"error"==textStatus&&(errors=jqXHR.responseJSON.errors,message=errors[0].message),failureCallback(message,errors)}})},TravelDuck_Photo.prototype.constructor=TravelDuck_Photo,TravelDuck_Property.prototype.constructor=TravelDuck_Property,TravelDuck_Property.searchInProgress=null,TravelDuck_Property.initialiseFromApi=function(propertyId,successCallback,failureCallback){var property=new TravelDuck_Property(propertyId);property.readFromApi(successCallback,failureCallback)},TravelDuck_Property.prototype.getAttributes=function(){return this.attributes},TravelDuck_Property.prototype.setAttributes=function(attributes){this.attributes=attributes},TravelDuck_Property.prototype.getAttribute=function(key){return this.attributes[key]},TravelDuck_Property.prototype.setAttribute=function(key,value){this.attributes[key]=value},TravelDuck_Property.prototype.getId=function(){return parseInt(this.getAttribute("id"))},TravelDuck_Property.prototype.setId=function(id){this.setAttribute("id",id)},TravelDuck_Property.prototype.getName=function(){return this.getAttribute("name")},TravelDuck_Property.prototype.setName=function(name){this.setAttribute("name",name)},TravelDuck_Property.prototype.getChangeOverDay=function(){return new DayOfWeek(this.getAttribute("change-over-day"))},TravelDuck_Property.prototype.setChangeOverDay=function(changeOverDay){this.setAttribute("change-over-day",changeOverDay.getNumber())},TravelDuck_Property.prototype.getMinimumNights=function(){return this.getAttribute("minimum-nights")},TravelDuck_Property.prototype.setMinimumNights=function(minimumNights){this.setAttribute("minimum-nights",minimumNights)},TravelDuck_Property.prototype.getBookingMode=function(){return this.getAttribute("booking-mode")},TravelDuck_Property.prototype.setBookingMode=function(bookingMode){this.setAttribute("booking-mode",bookingMode)},TravelDuck_Property.prototype.hasMinimumPrice=function(){return null!=this.getMinimumPrice()},TravelDuck_Property.prototype.getMinimumPrice=function(){var data=this.getAttribute("minimum-price");return data&&data.value&&data.currency?new Amount(data.value,data.currency):null},TravelDuck_Property.prototype.getTurnAroundPeriod=function(){return this.getAttribute("turn-around-period")},TravelDuck_Property.prototype.hasWeeklyTurnAround=function(){return"weekly"==this.getTurnAroundPeriod()},TravelDuck_Property.prototype.hasNightlyTurnAround=function(){return"nightly"==this.getTurnAroundPeriod()},TravelDuck_Property.prototype.readFromApi=function(successCallback,failureCallback){successCallback=successCallback?successCallback:function(){},failureCallback=failureCallback?failureCallback:function(){};var property=this;$.ajax({url:"https://travelduck.co/api/rest/v1/property/"+property.getId()+"?callback=?",type:"GET",dataType:"jsonp",crossDomain:!0,cache:!1,timeout:1e4,success:function(response){if(response.errors.length>0)return void failureCallback();if(response){var data=response.payload;data?(property.setAttributes(data),successCallback(property)):successCallback(null)}else successCallback(null)},error:function(){failureCallback()}})},TravelDuck_Property.prototype.bookingQuote=function(calendarDayRange,numberOfAdults,numberOfChildren,numberOfInfants,numberOfPets,successCallback,failureCallback){successCallback=successCallback?successCallback:function(){},failureCallback=failureCallback?failureCallback:function(){};var propertyId=this.getId();$.ajax({url:"https://travelduck.co/api/rest/v1/property/"+propertyId+"/booking-quote?callback=?",type:"GET",dataType:"jsonp",crossDomain:!0,cache:!1,timeout:1e4,data:{"number-of-adults":numberOfAdults,"number-of-children":numberOfChildren,"number-of-infants":numberOfInfants,"number-of-pets":numberOfPets,currency:"GBP","start-date":calendarDayRange.getStartCalendarDay().toYearMonthDayString(),"end-date":calendarDayRange.getEndCalendarDay().toYearMonthDayString()},success:function(response){if(response.errors.length>0)return void failureCallback();if(response){var prices=response.payload;if(prices){var rentalPrice=new Amount(prices["rental-price"].value.toFixed(2),prices["rental-price"].currency),moneyHandlingFee=new Amount(prices["money-handling-fee"].value.toFixed(2),prices["money-handling-fee"].currency),totalPrice=new Amount(prices["total-price"].value.toFixed(2),prices["total-price"].currency);successCallback(totalPrice,rentalPrice,moneyHandlingFee)}else successCallback(null)}else successCallback(null)},error:function(){failureCallback()}})},TravelDuck_Property.prototype.availability=function(calendarMonthRange,successCallback,failureCallback){successCallback=successCallback?successCallback:function(){},failureCallback=failureCallback?failureCallback:function(){};var propertyId=this.getId();$.ajax({url:"https://travelduck.co/api/rest/v1/property/"+propertyId+"/availability?jsoncallback=?",type:"GET",dataType:"jsonp",crossDomain:!0,cache:!1,timeout:1e4,data:{"start-date":calendarMonthRange.getStartCalendarMonth().firstCalendarDay().toYearMonthDayString(),"end-date":calendarMonthRange.getEndCalendarMonth().lastCalendarDay().toYearMonthDayString()},success:function(response){if(response.errors.length>0)return void failureCallback();var available=response.payload.available.map(function(dateAsStr){return CalendarDay.fromYearMonthDayString(dateAsStr,"-")}),unavailable=response.payload.unavailable.map(function(dateAsStr){return CalendarDay.fromYearMonthDayString(dateAsStr,"-")}),availability={available:available,unavailable:unavailable};successCallback(availability)},error:failureCallback})},TravelDuck_Property.prototype.colouredAvailability=function(calendarMonthRange,successCallback,failureCallback){var months=calendarMonthRange.getArrayOfAllCalendarMonths();this.availability(calendarMonthRange,function(availability){var colouring={availableToAvailable:[],availableToUnavailable:[],availableToUnknown:[],unavailableToAvailable:[],unavailableToUnavailable:[],unavailableToUnknown:[],unknownToAvailable:[],unknownToUnavailable:[],unknownToUnknown:[]};months.forEach(function(calendarMonth){for(var daysInMonth=calendarMonth.daysInMonth(),day=1;daysInMonth>=day;day++){var currentDay=new CalendarDay(calendarMonth,day),previousDay=currentDay.minusDays(1),currentDayIsAvailable=availability.available.contains(currentDay),previousDayIsAvailable=availability.available.contains(previousDay),currentDayIsUnavailable=availability.unavailable.contains(currentDay),previousDayIsUnavailable=availability.unavailable.contains(previousDay),currentDayIsUnknown=!(currentDayIsAvailable||currentDayIsUnavailable),previousDayIsUnknown=!(previousDayIsAvailable||previousDayIsUnavailable);previousDayIsAvailable?currentDayIsAvailable?colouring.availableToAvailable.push(currentDay):currentDayIsUnavailable?colouring.availableToUnavailable.push(currentDay):currentDayIsUnknown&&colouring.availableToUnknown.push(currentDay):previousDayIsUnavailable?currentDayIsAvailable?colouring.unavailableToAvailable.push(currentDay):currentDayIsUnavailable?colouring.unavailableToUnavailable.push(currentDay):currentDayIsUnknown&&colouring.unavailableToUnknown.push(currentDay):previousDayIsUnknown&&(currentDayIsAvailable?colouring.unknownToAvailable.push(currentDay):currentDayIsUnavailable?colouring.unknownToUnavailable.push(currentDay):currentDayIsUnknown&&colouring.unknownToUnknown.push(currentDay))}}),successCallback(colouring,availability)},failureCallback)},TravelDuck_Property.boundarySearch=function(successCallback,failureCallback,top,left,bottom,right,numberOfResults,page){TravelDuck_Property.searchInProgress&&TravelDuck_Property.searchInProgress.abort(),successCallback=null!=successCallback?successCallback:function(){},failureCallback=null!=failureCallback?failureCallback:function(){},TravelDuck_Property.searchInProgress=$.ajax({url:"https://travelduck.co/api/rest/v1/property/search/boundary?jsoncallback=?",type:"GET",dataType:"jsonp",crossDomain:!0,cache:!1,timeout:1e4,data:{top:top,left:left,bottom:bottom,right:right,numberOfResults:numberOfResults,page:page},success:function(response){return response.errors.length>0?void failureCallback():void successCallback(response.payload)},error:function(jqXHR,textStatus){"abort"!=textStatus&&failureCallback()},complete:function(){TravelDuck_Property.searchInProgress=null}})},TravelDuck_Property.search=function(searchCriteria,successCallback,failureCallback,noResultsCallback){TravelDuck_Property.searchInProgress&&TravelDuck_Property.searchInProgress.abort(),successCallback=null!=successCallback?successCallback:function(){},failureCallback=null!=failureCallback?failureCallback:function(){},noResultsCallback=null!=noResultsCallback?noResultsCallback:function(){},TravelDuck_Property.searchInProgress=$.ajax({url:"https://travelduck.co/api/rest/v1/property/search-results?jsoncallback=?",type:"GET",dataType:"jsonp",crossDomain:!0,cache:!1,timeout:1e4,data:searchCriteria,success:function(response){var properties=response.properties;"[object Array]"===Object.prototype.toString.call(properties)?0==properties.length?noResultsCallback():(properties=properties.map(function(propertyJsonObject){return TravelDuck_Property.initialiseFromJsonObject(propertyJsonObject)}),successCallback(response.searchIdentifier,properties)):failureCallback()},error:function(jqXHR,textStatus){"abort"!=textStatus&&failureCallback()},complete:function(){TravelDuck_Property.searchInProgress=null}})},TravelDuck_Property_Booking_Request.prototype.constructor=TravelDuck_Property_Booking_Request,TravelDuck_Property_Booking_Request.prototype.submit=function(successCallback,failureCallback){successCallback=successCallback?successCallback:function(){},failureCallback=failureCallback?failureCallback:function(){},$.ajax({url:"https://travelduck.co/api/rest/v1/property/booking/request",type:"POST",crossDomain:!0,cache:!1,timeout:1e4,data:{"property-id":this.property.getId(),"start-date":this.dateRange.getStartCalendarDay().toYearMonthDayString(),"end-date":this.dateRange.getEndCalendarDay().toYearMonthDayString()},success:function(response){return response.errors.length>0?void failureCallback():void successCallback(response.payload)},error:failureCallback})},TravelDuck_Property_Booking_Guest.prototype.constructor=TravelDuck_Property_Booking_Guest;